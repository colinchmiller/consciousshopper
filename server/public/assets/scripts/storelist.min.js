/*! tcs_master 2015-12-18 */
function appDom(a){for(var b=0;b<a.length;b++){var c=(3963.2*a[b].distance).toFixed(1),d="https://www.google.com/maps/dir/Current+Location/",e=a[b].latlong[0],f=a[b].latlong[1],g=d+e+","+f;$("#storeList").append('<div class="container"><div class="col-xs-4"><img src="http://www.fillmurray.com/500/400" alt="store logo"/></div><div class="col-xs-8"><h4><a href="store.html"><strong>'+a[b].name+" </strong></a></h4></br><h5>"+c+' miles</h5><button><a href=" '+g+' ">Directions</button></div></div>')}}function displayLoading(){$("#spin").addClass("spinner")}function displayCompleted(){$("#spin").removeClass("spinner")}var myLatLng={},storesFound=[],storeContent=[];$(document).ready(function(){displayLoading(),getCurrentLocation()});var findStore=function(){console.log("The location data being sent to the db as search criteria: ",myLatLng),$.ajax({type:"GET",url:"/addStore",data:myLatLng,success:function(a){return console.log("The data response from the db: ",a),storesFound=a,appDom(storesFound),displayCompleted(),storesFound}})},getCurrentLocation=function(){function a(a,b,c){b.setPosition(c),b.setContent(a?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation.")}myLatLng={},navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){myLatLng.lat=parseFloat(a.coords.latitude),myLatLng.lng=parseFloat(a.coords.longitude),console.log("The variable LatLng: ",myLatLng),findStore()}):a(!1,infoWindow,map.getCenter())};